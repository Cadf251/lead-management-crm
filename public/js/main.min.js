(()=>{function i(o,e="",r=null){fetch(o,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:e}).then(t=>t.json()).then(t=>(console.log(t),r!==null&&typeof r=="function"&&r(t),t))}var q=null;function n(o,e,r=!0,t=null){let a=document.querySelector(".warning");q=t,a.innerHTML=`
    <div>
      <b class="warning__titulo">${o}</b>
      <p class="warning__descricao">${e}</p>

      <div class="warning__buttons">
        ${r?`
              <button class="small-btn small-btn--blue" data-warning-confirm="true">Sim</button>
              <button class="small-btn small-btn--red" data-warning-confirm="false">Cancelar</button>
            `:`
              <button class="small-btn small-btn--blue" data-warning-confirm="true">Ok</button>
            `}
      </div>
    </div>
  `,a.classList.add("warning--show")}function y(){document.addEventListener("click",o=>{let e=o.target.closest("[data-warning-confirm]");if(!e)return;let r=e.dataset.warningConfirm==="true";document.querySelector(".warning").classList.remove("warning--show"),r&&typeof q=="function"&&q(),q=null}),document.addEventListener("DOMContentLoaded",()=>{let o=document.getElementById("session-warning");if(!o)return;let e=o.dataset.warningTitulo,r=o.dataset.warningMensagem,t=o.dataset.warningAsk==="true";n(e,r,t)})}function x(){let o=document.querySelector(".js--overlay"),e=document.querySelector(".js--body"),r=document.querySelector(".js--overlay-content"),t=document.querySelector(".js--overlay-close");t!==null&&t.addEventListener("click",()=>{o.classList.contains("overlay--oculto")||n("Deseja fechar?","Todo progresso ser\xE1 descartado.",!0,()=>{o.classList.add("overlay--oculto"),e.classList.remove("congelado"),r.innerHTML=""})})}function c(){let o=document.querySelector(".js--overlay"),e=document.querySelector(".js--body");o.classList.contains("overlay--oculto")&&(o.classList.remove("overlay--oculto"),e.classList.add("congelado"))}function l(o){let e=document.querySelector(".js--overlay-content");e.innerHTML=o}function E(){i("http://crm.local/criar-usuario/","",o=>{c(),l(o.html)})}var u="http://crm.local/";function p(o,e){var r=document.querySelector(e);r.innerHTML=o}function g(o){var e=document.querySelector(o);e.remove()}function I(o,e){var r=e.usuarioId,t=e.usuarioNome;n("Deseja desativar o usu\xE1rio "+t+"?","Ele perder\xE1 o acesso, mas seus dados continuar\xE3o no hist\xF3rico do sistema.",!0,()=>{i(u+"desativar-usuario/"+r,"",a=>{p(a.html,".card--"+r),n(a.alerta,a.mensagens,!1)})})}function L(o,e){var r=e.usuarioId;i(u+"editar-usuario/"+r,"",t=>{c(),l(t.html)})}function S(o,e){var r=e.usuarioId,t=e.usuarioNome;n("Deseja reativar o usu\xE1rio "+t+"?","Ele ter\xE1 acesso a praticamente tudo que tinha antes.",!0,()=>{i(u+"/reativar-usuario/"+r,"",a=>{p(a.html,".card--"+r),n(a.alerta,a.mensagens,!1)})})}function j(o,e){var r=e.usuarioId,t=e.usuarioNome;n("Deseja reenviar o email do "+t+"?","O email de redefini\xE7\xE3o de senha senha enviado.",!0,()=>{i(u+"/reenviar-email/"+r,"",a=>{p(a.html,".card--"+r),n(a.alerta,a.mensagens,!1)})})}function w(o,e){var r=e.usuarioId,t=e.usuarioNome;n("Deseja resetar a senha do "+t+"?","Ao resetar a senha, ser\xE1 enviado o email para o usu\xE1rio criar uma nova.",!0,()=>{i(u+"resetar-senha/"+r,"",a=>{p(a.html,".card--"+r),n(a.alerta,a.mensagens,!1)})})}var N={"usuario:criar":E,"usuario:editar":L,"usuario:reenviar-email":j,"usuario:desativar":I,"usuario:reativar":S,"usuario:resetar-senha":w};function T(o,e){var r=e.colaboradorId,t=o.previousElementSibling,a=t.value;i("http://crm.local/alterar-funcao/"+r,"funcao_id="+a,s=>{s.sucesso===!0||s.sucesso!==void 0?(o.dataset.originalValue=a,o.disabled=!0):n(sucesso.alerta,sucesso.mensagens,!1)})}function R(o,e){var r="switch-btn--ativado",t="switch-btn--desativado",a=!o.classList.contains(r),s=e.colaboradorId,d=e.equipeId,m=o.closest("td"),f=m.nextElementSibling,v=f.querySelectorAll("button");i("http://crm.local/alterar-recebimento/"+s,"recebe_leads="+a+"&equipe_id="+d,b=>{if(b.sucesso===!0){a?(o.innerHTML="Sim",o.classList.remove(t),o.classList.add(r),v.forEach(h=>{h.disabled=!1})):(o.innerHTML="N\xE3o",o.classList.remove(r),o.classList.add(t),v.forEach(h=>{h.disabled=!0}));var Q=document.querySelector(".js--infobox");Q.innerHTML=b.fila}else n(b.alerta,b.mensagens,!1)})}function C(o,e){var r=e.equipeId,t=e.equipeNome;n("Deseja despausar a equipe "+t+"?","Ela voltar\xE1 a receber leads normalmente.",!0,()=>{i(u+"/ativar-equipe/"+r,"",a=>{p(a.html,".card--"+r),n(a.alerta,a.mensagens,!1)})})}function W(o,e){var r=e.colaboradorId,t=e.equipeId;i("http://crm.local/mudar-vez/"+r,"task=prejudicar&equipe_id="+t,a=>{var s=document.querySelector(".js--infobox");s.innerHTML=a.fila})}function O(o,e){var r=e.colaboradorId,t=e.equipeId;i("http://crm.local/mudar-vez/"+r,"task=priorizar&equipe_id="+t,a=>{var s=document.querySelector(".js--infobox");s.innerHTML=a.fila})}function z(){i("http://crm.local/criar-equipe/","",o=>{c(),l(o.html)})}function D(o,e){var r=e.equipeId,t=e.equipeNome;n("Deseja desativar a equipe "+t+"?","Ela ser\xE1 completamente exclu\xEDda.",!0,()=>{i(u+"/desativar-equipe/"+r,"",a=>{g(".card--"+r),n(a.alerta,a.mensagens,!1)})})}function M(o,e){var r=e.equipeId;i("http://crm.local/editar-equipe/"+r,"",t=>{c(),l(t.html)})}function A(){let o=document.querySelector(".js--usuario-select");if(console.log("acessado"),o===null)return;console.log(o);let e=document.querySelector(".js--usuario-funcao");console.log(e);let r=e.querySelector("option[value='2']");console.log(r),o.addEventListener("change",()=>{let a=o.value.split(","),s=parseInt(a[1]);console.log(s),s>=3?(e.selectedIndex=0,r.disabled=!1):(e.selectedIndex=0,r.disabled=!0)})}function B(o,e){var r=e.equipeId;i(u+"novo-colaborador/"+r,"",t=>{c(),l(t.html),A()})}function _(o,e){var r=e.equipeId,t=e.equipeNome;n("Deseja pausar a equipe "+t+"?","Ela n\xE3o receber\xE1 leads enquanto estiver pausada.",!0,()=>{i(u+"/congelar-equipe/"+r,"",a=>{p(a.html,".card--"+r),n(a.alerta,a.mensagens,!1)})})}function H(o,e){var r=e.colaboradorId,t=e.equipeId;i("http://crm.local/remover-colaborador/"+r,"equipe_id="+t,a=>{var s=document.querySelector(".js--infobox");s.innerHTML=a.fila;var d=o.closest("tr");d.remove();var m=document.querySelector(".js--number-badge");m.innerHTML=a.numero})}var k={"equipe:criar":z,"equipe:editar":M,"equipe:desativar":D,"equipe:pausar":_,"equipe:ativar":C,"colaborador:novo":B,"colaborador:alterar-funcao":T,"colaborador:recebimento":R,"colaborador:prejudicar":W,"colaborador:priorizar":O,"colaborador:remover":H};function F(){i("http://crm.local/criar-produto/","",o=>{c(),l(o.html)})}function U(o,e){var r=e.productId,t=e.productName;n("Deseja deletar o produto "+t+"?","Ele ser\xE1 completamente exclu\xEDdo para sempre.",!0,()=>{i(u+"/deletar-produto/"+r,"",a=>{g(".card--"+r),n(a.alerta,a.mensagens,!1)})})}function P(o,e){var r=e.productId;i("http://crm.local/editar-produto/"+r,"",t=>{c(),l(t.html)})}var $={"product:create":F,"product:edit":P,"product:delete":U};var X={...N,...k,...$};function V(){document.addEventListener("click",o=>{let e=o.target.closest("[data-action]");if(!e)return;let r=e.dataset.action;X[r]?.(e,e.dataset)})}function G(){let o=document.querySelector(".js--nav");if(!o)return;let e=document.querySelector(".js--main"),r=document.querySelector(".js--nav-button");var t=o.classList,a=e.classList;r.addEventListener("click",()=>{let m=localStorage.getItem("navExpandida")==="true";d(!m,t,a),localStorage.setItem("navExpandida",!m)});function s(){let m=localStorage.getItem("navExpandida")==="true";d(m,t,a),t.contains("nav--preload")&&t.remove("nav--preload")}function d(m,f,v){m?(f.remove("nav--recolhido"),f.add("nav--extendido"),v.remove("main--recolhido"),v.add("main--extendido")):(f.remove("nav--extendido"),f.add("nav--recolhido"),v.remove("main--extendido"),v.add("main--recolhido"))}s()}function Y(){document.addEventListener("change",function(o){let e=o.target;(e.tagName==="INPUT"||e.tagName==="TEXTAREA"||e.tagName==="SELECT")&&e.closest(".js--form-edit")&&(e.classList.contains("input--changed")||e.classList.add("input--changed"))})}function J(){let o=document.createElement("div"),r=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/2;o.className="tooltip";function t(s){let d=s.getAttribute("title");d&&(s.dataset.tooltipText=d,s.hasAttribute("data-tooltip-applied")||(s.removeAttribute("title"),s.setAttribute("data-tooltip-applied","true"),s.addEventListener("mouseenter",()=>{o.textContent=s.dataset.tooltipText,o.style.opacity=1}),s.addEventListener("mousemove",m=>{o.style.top=`${m.pageY+12}px`,m.pageX<r?o.style.left=`${m.pageX+12}px`:o.style.left=`${m.pageX-o.offsetWidth-12}px`}),s.addEventListener("mouseleave",()=>{o.style.opacity=0})))}window.onload=()=>{document.body.appendChild(o),document.querySelectorAll("[title]").forEach(t),a.observe(document.body,{attributes:!0,subtree:!0,attributeFilter:["title"]})};let a=new MutationObserver(s=>{s.forEach(d=>{d.type==="attributes"&&d.attributeName==="title"&&t(d.target)})})}function K(){let o=document.querySelectorAll(".js--usuario-funcao");o&&o.forEach(e=>{let r=e.nextElementSibling,t=e.value;e.addEventListener("change",()=>{r.disabled=r.dataset.originalValue===e.value})})}G();x();y();V();Y();J();K();})();
