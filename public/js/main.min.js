(()=>{async function x(e,t,o){try{let n=await(await fetch(e,t)).json();return o&&typeof o=="function"&&o(n),n}catch(r){console.error("Erro na requisi\xE7\xE3o AJAX:",r)}}function L(e,t=null){return x(e,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest"}},t)}function a(e,t="",o=null){return x(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-Requested-With":"XMLHttpRequest"},body:t},o)}var g=null;function l(e,t,o=!0,r=null){let n=document.querySelector(".warning");g=r,n.innerHTML=`
    <div>
      <b class="warning__titulo">${e}</b>
      <p class="warning__descricao">${t}</p>

      <div class="warning__buttons">
        ${o?`
              <button class="small-btn small-btn--blue" data-warning-confirm="true">Sim</button>
              <button class="small-btn small-btn--red" data-warning-confirm="false">Cancelar</button>
            `:`
              <button class="small-btn small-btn--blue" data-warning-confirm="true">Ok</button>
            `}
      </div>
    </div>
  `,n.classList.add("warning--show")}function q(){document.addEventListener("click",e=>{let t=e.target.closest("[data-warning-confirm]");if(!t)return;let o=t.dataset.warningConfirm==="true";document.querySelector(".warning").classList.remove("warning--show"),o&&typeof g=="function"&&g(),g=null}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("session-warning");if(!e)return;let t=e.dataset.warningTitulo,o=e.dataset.warningMensagem,r=e.dataset.warningAsk==="true";l(t,o,r)})}function S(){let e=document.querySelector(".js--overlay"),t=document.querySelector(".js--body"),o=document.querySelector(".js--overlay-content"),r=document.querySelector(".js--overlay-close");r!==null&&r.addEventListener("click",()=>{e.classList.contains("overlay--oculto")||l("Deseja fechar?","Todo progresso ser\xE1 descartado.",!0,()=>{e.classList.add("overlay--oculto"),t.classList.remove("congelado"),o.innerHTML=""})})}function f(){let e=document.querySelector(".js--overlay"),t=document.querySelector(".js--body");e.classList.contains("overlay--oculto")&&(e.classList.remove("overlay--oculto"),t.classList.add("congelado"))}function p(e){let t=document.querySelector(".js--overlay-content");t.innerHTML=e}function E(){let e=document.querySelector(".js--overlay"),t=document.querySelector(".js--body");e.classList.add("overlay--oculto"),t.classList.remove("congelado");let o=document.querySelector(".js--overlay-content");o.innerHTML=""}function w(){a("http://crm.local/criar-produto/","",e=>{f(),p(e.html)})}var c="http://crm.local/";function T(e){var t=document.querySelector(e);t!==null&&t.remove()}function j(e){var t=document.querySelector(e);t!==null&&t.classList.add("is-loading")}function _(e){var t=document.querySelector(e);t!==null&&t.classList.remove("is-loading")}function R(e,t){var o=t.productId,r=t.productName;l("Deseja deletar o produto "+r+"?","Ele ser\xE1 completamente exclu\xEDdo para sempre.",!0,()=>{a(c+"/deletar-produto/"+o,"",n=>{T(".card--"+o),l(n.alerta,n.mensagens,!1)})})}function A(e,t){var o=t.productId;a("http://crm.local/editar-produto/"+o,"",r=>{f(),p(r.html)})}var H={"product:create":w,"product:edit":A,"product:delete":R};function M(){a("http://crm.local/criar-oferta/","",e=>{f(),p(e.html)})}var C={"offer:create":M};var v={container:null,init(){this.container||(document.body.insertAdjacentHTML("beforeend",`
        <div class="floating-action js--floating-container">
          <div class="floating-action__content js--floating-content"></div>
        </div>`),this.container=document.querySelector(".js--floating-container"),this.bindCloseEvents())},bindCloseEvents(){document.addEventListener("mousedown",e=>{this.container?.classList.contains("is-active")&&!this.container.contains(e.target)&&this.close()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&this.close()})},open(e,t){this.init();let o=e.getBoundingClientRect(),r=o.left,n=o.top+o.height;console.log("Floating Action disparado!"),console.log("ID solicitado:",t),console.log(`Coordenadas: X:${r} Y:${n}`);let s=this.container.querySelector(".js--floating-content");s.innerHTML='<div class="floating-loader">Simulando Loading...</div>',this.container.classList.add("is-loading"),this.container.classList.add("is-active"),this.setPosition(r,n)},fill(e){var t=this.container.querySelector(".js--floating-content");this.container.classList.remove("is-loading"),t.innerHTML=e},setPosition(e,t){let n=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/2;e<n?this.container.style.left=`${e+10}px`:(console.log(this.container.offsetWidth),this.container.style.left=`${e-this.container.offsetWidth-10}px`),this.container.style.top=`${t-10}px`},close(){this.container&&(this.container.classList.remove("is-active"),this.container.querySelector(".js--floating-content").innerHTML="")}};function W(e,t){let o=e;v.open(o,"offer-team"),a(c+"floating-action/offer-team","",r=>{v.fill(r.html)})}function I(e,t){let o=e,r=t.floatingId;v.open(o,r),a(c+"floating-action/"+r,"",n=>{v.fill(n.html)})}var k={"floating:teste":I,"floating:offer-team":W};var h=(e,t=null)=>{if(e){if(e.redirect){window.location.href=c+e.redirect;return}if(e.updates&&Array.isArray(e.updates)&&e.updates.forEach(o=>{let r=o.target?document.querySelector(o.target):null;switch(o.type){case"change":r&&(r.outerHTML=o.html);break;case"update":r&&(r.innerHTML=o.html);break;case"append":r&&r.insertAdjacentHTML("beforeend",o.html);break;case"remove":r&&r.remove();break;case"overlay":f(),p(o.html);break}}),e.close_overlay&&E(),!e.success&&e.csrf_token&&t){let r=t.closest("form")?.querySelector("input[name='csrf_token']");r&&(r.value=e.csrf_token)}e.messages&&l(e.alert,e.messages,!1)}};function F(){document.addEventListener("submit",e=>{e.target.classList.contains("js--form-ajax")&&e.preventDefault()})}var O={submit(e){let t=e.closest(".js--form-ajax");if(!t||!re.validate(t))return!1;let o=new FormData(t),r=t.action||window.location.href,n=new URLSearchParams(o).toString();e.disabled=!0;let s=e.innerHTML;e.innerHTML="Enviando...",a(r,n,i=>{e.disabled=!1,e.innerHTML=s,h(i,e)})}},re={validate(e){let t=e.querySelectorAll("input, select, textarea"),o=!0;return t.forEach(r=>{this.clearError(r),r.hasAttribute("required")&&!r.value.trim()&&(this.setError(r,"Campo obrigat\xF3rio"),o=!1),(r.type==="email"||r.type==="mail")&&r.value&&(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.value)||(this.setError(r,"E-mail inv\xE1lido"),o=!1))}),o},setError(e,t){e.classList.add("input--error");var o=e.closest(".form__campo").querySelector("label");o.innerHTML=o.innerHTML+t},clearError(e){e.classList.remove("input--error")}};function B(e,t){O.submit(e)}var N={"form:ajax-submit":B};var y={run(e,t){let o=t.url;t.confirm?l(t.confirmTitle,t.confirmText,!0,()=>y.execute(o,e,t)):y.execute(o,e,t)},execute(e,t,o){let r=new URLSearchParams;o.target&&j(o.target),Object.keys(o).forEach(i=>{if(i.startsWith("param")){let m=i.replace("param","").replace(/([A-Z])/g,"_$1").toLowerCase().replace(/^_/,"");r.append(m,o[i])}}),o.include&&document.querySelectorAll(o.include).forEach(i=>{i.name&&i.value!==void 0&&r.append(i.name,i.value)});let n=o.actionType==="overlay",s=i=>{o.target&&_(o.target),h(i,t)};if(n)L(c+e,s);else{let i=r.toString();a(c+e,i,s)}}};var $={"action:core":y.run};function P(e,t){console.log("Called");var o=e.nextElementSibling;o.classList.contains("is-active")?(o.classList.remove("is-active"),e.classList.remove("is-active")):(o.classList.add("is-active"),e.classList.add("is-active"))}var D={"ui:hamburguer-controller":P};function X(e,t){var o=e.previousElementSibling,r=o.value;a(c+t.url,"funcao_id="+r,n=>{n.success?(e.dataset.originalValue=r,e.disabled=!0):l(success.alert,success.messages,!1)})}var ne=document.querySelector(".js--infobox");function V(e,t){var o=t.equipeId,r=t.set;a(c+t.url,"set="+r+"&equipe_id="+o,n=>{console.log(n),n.success===!0?ne.innerHTML=n.info_box_html:l(n.alert,n.messages,!1)})}var ie=document.querySelector(".js--infobox");function U(e,t){var o=t.equipeId,r="switch-btn--ativado",n="switch-btn--desativado",s=!e.classList.contains(r),i=e.closest("td"),m=i.nextElementSibling,u=m.querySelectorAll("button");a(c+t.url,"recebe_leads="+s+"&equipe_id="+o,d=>{d.success===!0?(s?(e.innerHTML="Sim",e.classList.remove(n),e.classList.add(r),u.forEach(b=>{b.disabled=!1})):(e.innerHTML="N\xE3o",e.classList.remove(r),e.classList.add(n),u.forEach(b=>{b.disabled=!0})),ie.innerHTML=d.info_box_html):l(d.alert,d.messages,!1)})}var z=document.querySelector(".js--infobox"),G=document.querySelector(".js--number-badge");function Y(e,t){var o=t.equipeId,r=e.closest("tr");a(c+t.url,"equipe_id="+o,n=>{console.log(n),n.success===!0?(console.log(n.info_box_html),console.log(n.number_badge_html),console.log(z),console.log(G),z.innerHTML=n.info_box_html,G.innerHTML=n.number_badge_html,r.remove()):l(n.alert,n.messages,!1)})}var J={"teamuser:alter-function":X,"teamuser:receiving":U,"teamuser:changetime":V,"teamuser:remove":Y};var Z={...$,...D,...J,...H,...C,...k,...N};function K(){document.addEventListener("click",e=>{let t=e.target.closest("[data-action]");if(!t)return;let o=t.dataset.action;Z[o]?.(t,t.dataset)})}function Q(){let e=document.querySelector(".js--nav");if(!e)return;let t=document.querySelector(".js--main"),o=document.querySelector(".js--nav-button");var r=e.classList,n=t.classList;o.addEventListener("click",()=>{let m=localStorage.getItem("navExpandida")==="true";i(!m,r,n),localStorage.setItem("navExpandida",!m)});function s(){let m=localStorage.getItem("navExpandida")==="true";i(m,r,n),r.contains("nav--preload")&&r.remove("nav--preload")}function i(m,u,d){m?(u.remove("nav--recolhido"),u.add("nav--extendido"),d.remove("main--recolhido"),d.add("main--extendido")):(u.remove("nav--extendido"),u.add("nav--recolhido"),d.remove("main--extendido"),d.add("main--recolhido"))}s()}function ee(){document.addEventListener("change",function(e){let t=e.target;(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.tagName==="SELECT")&&t.closest(".js--form-edit")&&(t.classList.contains("input--changed")||t.classList.add("input--changed"))})}function te(){let e=document.createElement("div"),o=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/2;e.className="tooltip";function r(s){let i=s.getAttribute("title");i&&(s.dataset.tooltipText=i,s.hasAttribute("data-tooltip-applied")||(s.removeAttribute("title"),s.setAttribute("data-tooltip-applied","true"),s.addEventListener("mouseenter",()=>{e.textContent=s.dataset.tooltipText,e.style.opacity=1}),s.addEventListener("mousemove",m=>{e.style.top=`${m.pageY+12}px`,m.pageX<o?e.style.left=`${m.pageX+12}px`:e.style.left=`${m.pageX-e.offsetWidth-12}px`}),s.addEventListener("mouseleave",()=>{e.style.opacity=0})))}window.onload=()=>{document.body.appendChild(e),document.querySelectorAll("[title]").forEach(r),n.observe(document.body,{attributes:!0,subtree:!0,attributeFilter:["title"]})};let n=new MutationObserver(s=>{s.forEach(i=>{i.type==="attributes"&&i.attributeName==="title"&&r(i.target)})})}function oe(){let e=document.querySelectorAll(".js--usuario-funcao");e&&e.forEach(t=>{let o=t.nextElementSibling,r=t.value;t.addEventListener("change",()=>{o.disabled=o.dataset.originalValue===t.value})})}Q();S();q();K();ee();te();oe();F();})();
