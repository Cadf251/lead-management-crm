(()=>{function i(e,t="",o=null){fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t}).then(r=>r.json()).then(r=>(console.log(r),o!==null&&typeof o=="function"&&o(r),r))}var b=null;function n(e,t,o=!0,r=null){let a=document.querySelector(".warning");b=r,a.innerHTML=`
    <div>
      <b class="warning__titulo">${e}</b>
      <p class="warning__descricao">${t}</p>

      <div class="warning__buttons">
        ${o?`
              <button class="small-btn small-btn--blue" data-warning-confirm="true">Sim</button>
              <button class="small-btn small-btn--red" data-warning-confirm="false">Cancelar</button>
            `:`
              <button class="small-btn small-btn--blue" data-warning-confirm="true">Ok</button>
            `}
      </div>
    </div>
  `,a.classList.add("warning--show")}function x(){document.addEventListener("click",e=>{let t=e.target.closest("[data-warning-confirm]");if(!t)return;let o=t.dataset.warningConfirm==="true";document.querySelector(".warning").classList.remove("warning--show"),o&&typeof b=="function"&&b(),b=null}),document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("session-warning");if(!e)return;let t=e.dataset.warningTitulo,o=e.dataset.warningMensagem,r=e.dataset.warningAsk==="true";n(t,o,r)})}function E(){let e=document.querySelector(".js--overlay"),t=document.querySelector(".js--body"),o=document.querySelector(".js--overlay-content"),r=document.querySelector(".js--overlay-close");r!==null&&r.addEventListener("click",()=>{e.classList.contains("overlay--oculto")||n("Deseja fechar?","Todo progresso ser\xE1 descartado.",!0,()=>{e.classList.add("overlay--oculto"),t.classList.remove("congelado"),o.innerHTML=""})})}function l(){let e=document.querySelector(".js--overlay"),t=document.querySelector(".js--body");e.classList.contains("overlay--oculto")&&(e.classList.remove("overlay--oculto"),t.classList.add("congelado"))}function u(e){let t=document.querySelector(".js--overlay-content");t.innerHTML=e}function L(){i("http://crm.local/criar-usuario/","",e=>{l(),u(e.html)})}var c="http://crm.local/";function p(e,t){var o=document.querySelector(t);o.innerHTML=e}function q(e){var t=document.querySelector(e);t.remove()}function I(e,t){var o=t.usuarioId,r=t.usuarioNome;n("Deseja desativar o usu\xE1rio "+r+"?","Ele perder\xE1 o acesso, mas seus dados continuar\xE3o no hist\xF3rico do sistema.",!0,()=>{i(c+"desativar-usuario/"+o,"",a=>{p(a.html,".card--"+o),n(a.alerta,a.mensagens,!1)})})}function S(e,t){var o=t.usuarioId;i(c+"editar-usuario/"+o,"",r=>{l(),u(r.html)})}function j(e,t){var o=t.usuarioId,r=t.usuarioNome;n("Deseja reativar o usu\xE1rio "+r+"?","Ele ter\xE1 acesso a praticamente tudo que tinha antes.",!0,()=>{i(c+"/reativar-usuario/"+o,"",a=>{p(a.html,".card--"+o),n(a.alerta,a.mensagens,!1)})})}function w(e,t){var o=t.usuarioId,r=t.usuarioNome;n("Deseja reenviar o email do "+r+"?","O email de redefini\xE7\xE3o de senha senha enviado.",!0,()=>{i(c+"/reenviar-email/"+o,"",a=>{p(a.html,".card--"+o),n(a.alerta,a.mensagens,!1)})})}function T(e,t){var o=t.usuarioId,r=t.usuarioNome;n("Deseja resetar a senha do "+r+"?","Ao resetar a senha, ser\xE1 enviado o email para o usu\xE1rio criar uma nova.",!0,()=>{i(c+"resetar-senha/"+o,"",a=>{p(a.html,".card--"+o),n(a.alerta,a.mensagens,!1)})})}var C={"usuario:criar":L,"usuario:editar":S,"usuario:reenviar-email":w,"usuario:desativar":I,"usuario:reativar":j,"usuario:resetar-senha":T};function R(e,t){var o=t.colaboradorId,r=e.previousElementSibling,a=r.value;i("http://crm.local/alterar-funcao/"+o,"funcao_id="+a,s=>{s.sucesso===!0||s.sucesso!==void 0?(e.dataset.originalValue=a,e.disabled=!0):n(sucesso.alerta,sucesso.mensagens,!1)})}function W(e,t){var o="switch-btn--ativado",r="switch-btn--desativado",a=!e.classList.contains(o),s=t.colaboradorId,d=t.equipeId,m=e.closest("td"),f=m.nextElementSibling,v=f.querySelectorAll("button");i("http://crm.local/alterar-recebimento/"+s,"recebe_leads="+a+"&equipe_id="+d,h=>{if(h.sucesso===!0){a?(e.innerHTML="Sim",e.classList.remove(r),e.classList.add(o),v.forEach(y=>{y.disabled=!1})):(e.innerHTML="N\xE3o",e.classList.remove(o),e.classList.add(r),v.forEach(y=>{y.disabled=!0}));var ie=document.querySelector(".js--infobox");ie.innerHTML=h.fila}else n(h.alerta,h.mensagens,!1)})}function N(e,t){var o=t.equipeId,r=t.equipeNome;n("Deseja despausar a equipe "+r+"?","Ela voltar\xE1 a receber leads normalmente.",!0,()=>{i(c+"/ativar-equipe/"+o,"",a=>{p(a.html,".card--"+o),n(a.alerta,a.mensagens,!1)})})}function A(e,t){var o=t.colaboradorId,r=t.equipeId;i("http://crm.local/mudar-vez/"+o,"task=prejudicar&equipe_id="+r,a=>{var s=document.querySelector(".js--infobox");s.innerHTML=a.fila})}function M(e,t){var o=t.colaboradorId,r=t.equipeId;i("http://crm.local/mudar-vez/"+o,"task=priorizar&equipe_id="+r,a=>{var s=document.querySelector(".js--infobox");s.innerHTML=a.fila})}function O(){i("http://crm.local/criar-equipe/","",e=>{l(),u(e.html)})}function H(e,t){var o=t.equipeId,r=t.equipeNome;n("Deseja desativar a equipe "+r+"?","Ela ser\xE1 completamente exclu\xEDda.",!0,()=>{i(c+"/desativar-equipe/"+o,"",a=>{q(".card--"+o),n(a.alerta,a.mensagens,!1)})})}function B(e,t){var o=t.equipeId;i("http://crm.local/editar-equipe/"+o,"",r=>{l(),u(r.html)})}function D(){let e=document.querySelector(".js--usuario-select");if(e===null)return;let t=document.querySelector(".js--usuario-funcao"),o=t.querySelector("option[value='2']");e.addEventListener("change",()=>{let a=e.value.split(",");parseInt(a[1])>=3?(t.selectedIndex=0,o.disabled=!1):(t.selectedIndex=0,o.disabled=!0)})}function z(e,t){var o=t.equipeId;i(c+"novo-colaborador/"+o,"",r=>{l(),u(r.html),D()})}function _(e,t){var o=t.equipeId,r=t.equipeNome;n("Deseja pausar a equipe "+r+"?","Ela n\xE3o receber\xE1 leads enquanto estiver pausada.",!0,()=>{i(c+"/congelar-equipe/"+o,"",a=>{p(a.html,".card--"+o),n(a.alerta,a.mensagens,!1)})})}function k(e,t){var o=t.colaboradorId,r=t.equipeId;i("http://crm.local/remover-colaborador/"+o,"equipe_id="+r,a=>{var s=document.querySelector(".js--infobox");s.innerHTML=a.fila;var d=e.closest("tr");d.remove();var m=document.querySelector(".js--number-badge");m.innerHTML=a.numero})}var F={"equipe:criar":O,"equipe:editar":B,"equipe:desativar":H,"equipe:pausar":_,"equipe:ativar":N,"colaborador:novo":z,"colaborador:alterar-funcao":R,"colaborador:recebimento":W,"colaborador:prejudicar":A,"colaborador:priorizar":M,"colaborador:remover":k};function $(){i("http://crm.local/criar-produto/","",e=>{l(),u(e.html)})}function P(e,t){var o=t.productId,r=t.productName;n("Deseja deletar o produto "+r+"?","Ele ser\xE1 completamente exclu\xEDdo para sempre.",!0,()=>{i(c+"/deletar-produto/"+o,"",a=>{q(".card--"+o),n(a.alerta,a.mensagens,!1)})})}function U(e,t){var o=t.productId;i("http://crm.local/editar-produto/"+o,"",r=>{l(),u(r.html)})}var X={"product:create":$,"product:edit":U,"product:delete":P};function V(){i("http://crm.local/criar-oferta/","",e=>{l(),u(e.html)})}var Y={"offer:create":V};var g={container:null,init(){this.container||(document.body.insertAdjacentHTML("beforeend",`
        <div class="floating-action js--floating-container">
          <div class="floating-action__content js--floating-content"></div>
        </div>`),this.container=document.querySelector(".js--floating-container"),this.bindCloseEvents())},bindCloseEvents(){document.addEventListener("mousedown",e=>{this.container?.classList.contains("is-active")&&!this.container.contains(e.target)&&this.close()}),document.addEventListener("keydown",e=>{e.key==="Escape"&&this.close()})},open(e,t){this.init();let o=e.getBoundingClientRect(),r=o.left,a=o.top+o.height;console.log("Floating Action disparado!"),console.log("ID solicitado:",t),console.log(`Coordenadas: X:${r} Y:${a}`);let s=this.container.querySelector(".js--floating-content");s.innerHTML='<div class="floating-loader">Simulando Loading...</div>',this.container.classList.add("is-loading"),this.container.classList.add("is-active"),this.setPosition(r,a)},fill(e){var t=this.container.querySelector(".js--floating-content");this.container.classList.remove("is-loading"),t.innerHTML=e},setPosition(e,t){let a=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/2;e<a?this.container.style.left=`${e+10}px`:(console.log(this.container.offsetWidth),this.container.style.left=`${e-this.container.offsetWidth-10}px`),this.container.style.top=`${t-10}px`},close(){this.container&&(this.container.classList.remove("is-active"),this.container.querySelector(".js--floating-content").innerHTML="")}};function G(e,t){let o=e;g.open(o,"offer-team"),i(c+"floating-action/offer-team","",r=>{g.fill(r.html)})}function J(e,t){let o=e,r=t.floatingId;g.open(o,r),i(c+"floating-action/"+r,"",a=>{g.fill(a.html)})}var K={"floating:teste":J,"floating:offer-team":G};var Q={...C,...F,...X,...Y,...K};function Z(){document.addEventListener("click",e=>{let t=e.target.closest("[data-action]");if(!t)return;let o=t.dataset.action;Q[o]?.(t,t.dataset)})}function ee(){let e=document.querySelector(".js--nav");if(!e)return;let t=document.querySelector(".js--main"),o=document.querySelector(".js--nav-button");var r=e.classList,a=t.classList;o.addEventListener("click",()=>{let m=localStorage.getItem("navExpandida")==="true";d(!m,r,a),localStorage.setItem("navExpandida",!m)});function s(){let m=localStorage.getItem("navExpandida")==="true";d(m,r,a),r.contains("nav--preload")&&r.remove("nav--preload")}function d(m,f,v){m?(f.remove("nav--recolhido"),f.add("nav--extendido"),v.remove("main--recolhido"),v.add("main--extendido")):(f.remove("nav--extendido"),f.add("nav--recolhido"),v.remove("main--extendido"),v.add("main--recolhido"))}s()}function te(){document.addEventListener("change",function(e){let t=e.target;(t.tagName==="INPUT"||t.tagName==="TEXTAREA"||t.tagName==="SELECT")&&t.closest(".js--form-edit")&&(t.classList.contains("input--changed")||t.classList.add("input--changed"))})}function oe(){let e=document.createElement("div"),o=(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)/2;e.className="tooltip";function r(s){let d=s.getAttribute("title");d&&(s.dataset.tooltipText=d,s.hasAttribute("data-tooltip-applied")||(s.removeAttribute("title"),s.setAttribute("data-tooltip-applied","true"),s.addEventListener("mouseenter",()=>{e.textContent=s.dataset.tooltipText,e.style.opacity=1}),s.addEventListener("mousemove",m=>{e.style.top=`${m.pageY+12}px`,m.pageX<o?e.style.left=`${m.pageX+12}px`:e.style.left=`${m.pageX-e.offsetWidth-12}px`}),s.addEventListener("mouseleave",()=>{e.style.opacity=0})))}window.onload=()=>{document.body.appendChild(e),document.querySelectorAll("[title]").forEach(r),a.observe(document.body,{attributes:!0,subtree:!0,attributeFilter:["title"]})};let a=new MutationObserver(s=>{s.forEach(d=>{d.type==="attributes"&&d.attributeName==="title"&&r(d.target)})})}function re(){let e=document.querySelectorAll(".js--usuario-funcao");e&&e.forEach(t=>{let o=t.nextElementSibling,r=t.value;t.addEventListener("change",()=>{o.disabled=o.dataset.originalValue===t.value})})}function ae(){let e=document.querySelectorAll(".js--hamb-controll");e&&e.forEach(t=>{t.addEventListener("click",()=>{var o=t.nextElementSibling;o.classList.contains("is-active")?(o.classList.remove("is-active"),t.classList.remove("is-active")):(o.classList.add("is-active"),t.classList.add("is-active"))})})}ee();E();x();Z();te();oe();re();ae();})();
